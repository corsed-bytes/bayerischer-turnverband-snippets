<div id="news">
  <div
    class="control"
    style="display: flex; align-items: center; justify-content: space-between"
  ></div>
  <div
    class="content"
    style="display: flex; flex-direction: column; padding: 0.5rem"
  >
    Lade Inhalt...
  </div>
</div>

<script>
  const test = `    <header>
        <div class="grid-container">
            <div class="grid-x grid-margin-x">
                <div class="cell medium-6 large-4">
                    <a href="/" class="logo">
                                                    <picture >
	<source srcset="/sport/regionen_hier_nicht/oberfranken/logo-btv-tbz-oberfranken.svg 1x" media="(min-width: 576px)" type="image/svg+xml" />
	<source srcset="/sport/regionen_hier_nicht/oberfranken/logo-btv-tbz-oberfranken.svg 1x" type="image/svg+xml" />
	<img src="/sport/regionen_hier_nicht/oberfranken/logo-btv-tbz-oberfranken.svg" width="168" height="60" alt="" loading="lazy" />
</picture>

                                            </a>
                </div>
                <div class="cell medium-6 large-8">
                    <div class="navToggle"></div>
                    <nav>
                        <ul>
                                                                                                <li class=" ">
                                        <a target="" class=" main" href="/oberfranken">
                                            Der Turnbezirk
                                        </a>
                                    </li>
                                                                                                                                <li class=" ">
                                        <a target="" class=" main" href="/bildung">
                                            Bildung
                                        </a>
                                    </li>
                                                                                                                                <li class=" ">
                                        <a target="" class=" main" href="/sport">
                                            Sport
                                        </a>
                                    </li>
                                                                                                                                <li class=" ">
                                        <a target="" class=" main" href="/vereinsservice">
                                            Vereinsservice
                                        </a>
                                    </li>
                                                                                                                                <li class=" ">
                                        <a target="" class=" main" href="https://www.btv-turnen.de/">
                                            Zum BTV
                                        </a>
                                    </li>
                                                                                                                                <li class=" icon">
                                        <a target="" class="icon search main" href="/suche">
                                            Suche
                                        </a>
                                    </li>
                                                                                                                                                                                                            </ul>
                    </nav>
                </div>
            </div>
        </div>
    </header>


        
        <main class="main">
                <div class="grid-container">
        <div class="grid-x">
            <article class="brick_copy cell">
                <h1>Alle Events im Überblick</h1>
            </article>

            <article class="filter cell">
                <form>
                    <div class="grid-x">
                        <div class="cell small-6 medium-4 large-2">
                            <select name="archive">
                                <option value="1" selected>Aktuelles</option>
                                <option value="0" >Archiv</option>
                            </select>
                        </div>
                        <div class="cell small-6 medium-4 large-2">
                            <select name="sport">
                                <option value="" selected>alle Sportarten</option>
                                                                    <option value="262" >4XF</option>
                                                                    <option value="45" >Aerobicturnen</option>
                                                                    <option value="37" >Aus- und Fortbildung</option>
                                                                    <option value="261" >Fitness &amp; Aerobic</option>
                                                                    <option value="40" >Fitness, Aerobic &amp; Trends</option>
                                                                    <option value="46" >Gerätturnen</option>
                                                                    <option value="172" >Gerätturnen männlich olympisch</option>
                                                                    <option value="47" >Gerätturnen olympisch</option>
                                                                    <option value="171" >Gerätturnen weiblich olympisch</option>
                                                                    <option value="42" >Gesundheits- und Präventionssport</option>
                                                                    <option value="27" >Gymnastik &amp; Tanz</option>
                                                                    <option value="38" >Gymwelt</option>
                                                                    <option value="58" >Kinderturnen</option>
                                                                    <option value="57" >Musik und Spielmannswesen</option>
                                                                    <option value="43" >Natur- und Outdoorsport</option>
                                                                    <option value="48" >Orientierungslauf</option>
                                                                    <option value="49" >Parkour</option>
                                                                    <option value="50" >Rhönradturnen</option>
                                                                    <option value="51" >Rhythmische Sportgymnastik</option>
                                                                    <option value="73" >Rope Skipping</option>
                                                                    <option value="41" >Seniorensport</option>
                                                                    <option value="39" >Show &amp; Vorführung</option>
                                                                    <option value="52" >Sportakrobatik</option>
                                                                    <option value="53" >TeamGym</option>
                                                                    <option value="54" >Trampolinturnen</option>
                                                                    <option value="55" >Turnerische Mehrkämpfe</option>
                                                                    <option value="56" >Turnerjugendwettkämpfe</option>
                                                                    <option value="44" >Wettkampfsport</option>
                                                            </select>
                        </div>
                        <div class="cell small-6 medium-4 large-2">
                            <select name="regio">
                                <option value="" selected>alle Regionen</option>
                                                                    <option value="82" >Allgäu</option>
                                                                    <option value="1402" >Amper-Würm</option>
                                                                    <option value="1341" >Ansbach</option>
                                                                    <option value="87" >Augsburg</option>
                                                                    <option value="1311" >Bayreuth-Kulmbach</option>
                                                                    <option value="1273" >Coburg-Frankenwald</option>
                                                                    <option value="1403" >Donau-Ilm</option>
                                                                    <option value="1270" >Donau-Wald</option>
                                                                    <option value="1312" >Fichtelgebirge-Nordoberfranken</option>
                                                                    <option value="84" >Iller-Donau</option>
                                                                    <option value="1405" >Inn-Chiem-Rupertigau</option>
                                                                    <option value="1268" >Landshut</option>
                                                                    <option value="1313" >Main-Spessart</option>
                                                                    <option value="63" >Mittelfranken</option>
                                                                    <option value="1342" >Mittelfranken Süd</option>
                                                                    <option value="1404" >München</option>
                                                                    <option value="28" >Niederbayern</option>
                                                                    <option value="1343" >Nürnberg, Fürth, Erlangen, </option>
                                                                    <option value="61" >Oberbayern</option>
                                                                    <option value="83" >Oberdonau</option>
                                                                    <option value="62" >Oberfranken</option>
                                                                    <option value="1406" >Oberland</option>
                                                                    <option value="65" >Oberpfalz</option>
                                                                    <option value="1317" >Oberpfalz-Nord</option>
                                                                    <option value="1318" >Oberpfalz-Süd</option>
                                                                    <option value="1314" >Rhön-Saale</option>
                                                                    <option value="66" >Schwaben</option>
                                                                    <option value="1315" >Schweinfurt-Haßberge</option>
                                                                    <option value="1274" >Südoberfranken</option>
                                                                    <option value="1269" >Unterdonau</option>
                                                                    <option value="64" >Unterfranken</option>
                                                                    <option value="1407" >Wendelstein</option>
                                                                    <option value="1316" >Würzburg</option>
                                                            </select>
                        </div>
                        <div class="cell shrink">
                            <button type="submit">
                                Filter anwenden
                            </button>
                        </div>
                    </div>
                </form>
            </article>

            <article class="brick_event list cell">
                <div class="grid-x grid-margin-x">
                                            <div class="cell">
                            <a class="item" href="/events/2022bmrsg">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">So</div>
                                                <h2>20</h2>
                                                <div class="day">Feb</div>
                                            </div>
                                                                                            <div class="to date">
                                                    <div class="dayname">So</div>
                                                    <h2>20</h2>
                                                    <div class="day">Mär</div>
                                                </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Ergebnisse: Bezirksmeisterschaften Rhythmische Sportgymnastik Schwaben
                                        </h2>
                                        <div class="place">Gersthofen</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/29. Münchner Pokal im TGM-TGW-KGW">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">So</div>
                                                <h2>03</h2>
                                                <div class="day">Jul</div>
                                            </div>
                                                                                            <div class="to date">
                                                    <div class="dayname">Sa</div>
                                                    <h2>31</h2>
                                                    <div class="day">Dez</div>
                                                </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0">Turnerjugendwettkämpfe</div>
                                        <h2 class="h4">
                                            29. Münchner Pokal im TGM/TGW/KGW
                                        </h2>
                                        <div class="place">Allach</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/kampfrichterlehrgang-für-gerätturnen-männlich">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">Mo</div>
                                                <h2>10</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Kampfrichterlehrgang Gerätturnen männlich P-Übungen
                                        </h2>
                                        <div class="place">Vilsbiburg; Ballsporthalle</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/dance2u">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">Sa</div>
                                                <h2>15</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                            <div class="to date">
                                                    <div class="dayname">So</div>
                                                    <h2>16</h2>
                                                    <div class="day">Okt</div>
                                                </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0">Gymnastik &amp; TanzShow &amp; Vorführung</div>
                                        <h2 class="h4">
                                            Dance2u
                                        </h2>
                                        <div class="place">Holzkirchen</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/bayernpokal_weiblich">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">Sa</div>
                                                <h2>15</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Bayern-Pokal weiblich
                                        </h2>
                                        <div class="place"></div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/bayernpokal_männlich">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">So</div>
                                                <h2>16</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Bayern-Pokal männlich
                                        </h2>
                                        <div class="place"></div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/gau-mm-gerätturnen-weiblich">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">Mo</div>
                                                <h2>17</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Gau-Mannschaftsmeisterschaften Gerätturnen weiblich
                                        </h2>
                                        <div class="place">Vilsbiburg</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/liga_weiblich_1">
                                <div class="grid-x grid-margin-x">
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">Sa</div>
                                                <h2>22</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Liga weiblich 1
                                        </h2>
                                        <div class="place"></div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                            <div class="cell">
                            <a class="item" href="/events/Gau-Mannschaftswettkämpfe Bayernpokal">
                                <div class="grid-x grid-margin-x">
                                                                            <div class="cell small-4 large-2">
                                            <div class="icon">
                                                <picture >
	<source srcset="/sport/regionen_hier_nicht/oberbayern/donau-ilm/bilder/2022/image-thumb__2421__events_icon/white-male-g37671fa69_640.jpg 1x, /sport/regionen_hier_nicht/oberbayern/donau-ilm/bilder/2022/image-thumb__2421__events_icon/white-male-g37671fa69_640@2x.jpg 2x" type="image/jpeg" />
	<img src="/sport/regionen_hier_nicht/oberbayern/donau-ilm/bilder/2022/image-thumb__2421__events_icon/white-male-g37671fa69_640.jpg" width="80" height="80" alt="" loading="lazy" />
</picture>

                                            </div>
                                        </div>
                                                                        <div class="cell small-8 large-3">
                                        <div class="dates">
                                            <div class="from date">
                                                <div class="dayname">So</div>
                                                <h2>23</h2>
                                                <div class="day">Okt</div>
                                            </div>
                                                                                    </div>
                                    </div>
                                    <div class="cell large-7">
                                        <div class="category mtm5 mtd0"></div>
                                        <h2 class="h4">
                                            Gau Mannschaftswettkämpfe Bayernpokal
                                        </h2>
                                        <div class="place">Gerolfing</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                                    </div>
                <div class="grid-x grid-margin-x mtm4 mtd4">
                    <div class="cell">
                        <div class="paging">
    <span class="curnumber">
        Seiten 1/13
    </span>

    <a class="first" href="/events?page=1">&lt;</a>

    
    <span class="pages">
                                    <a class="current" href="/events?page=1">
                    1
                </a>
                                                <a class="page" href="/events?page=2">
                    2
                </a>
                                                <a class="page" href="/events?page=3">
                    3
                </a>
                                                <a class="page" href="/events?page=4">
                    4
                </a>
                                                <a class="page" href="/events?page=5">
                    5
                </a>
                        </span>

            <a class="next" href="/events?page=2">Weiter</a>
    
    <a class="last" href="/events?page=15">&gt;</a>
</div>
                    </div>
                </div>
            </article>
        </div>
    </div>


        </main>

                    


                
        
    
        
    <footer class="mt">
        <div class="bgblue">
            <div class="grid-container">
                <div class="grid-x grid-margin-x">
                    <div class="cell">
                        <h5>
                            Bayerischer Turnverband e. V. - Wir sind Bayerns Fitmacher!
                        </h5>
                    </div>
                </div>
            </div>
        </div>
        <div class="bgwhite">
            <div class="grid-container">
                <div class="grid-x grid-margin-x">
                    <div class="cell medium-6 large-3">
                        <p><a href="https://btv-turnen.de/der-btv/karriere" target="_blank">Karriere</a></p>

<p>Werde Teil unseres Teams - egal ob im Ehrenamt oder Hauptamt. Wir freuen uns auf dich!</p>

                    </div>
                    <div class="cell medium-6 large-3">
                        <p><a href="/kontakt">Kontakt</a></p>

<p>Du hast uns etwas zu sagen oder eine Frage brennt dir unter den Nägeln? Wir helfen dir gerne weiter.</p>

                    </div>
                    <div class="cell medium-6 large-3">
                        <p><a href="https://btv-turnen.de/der-btv/ueber-uns/impressum" target="_blank">Impressum</a></p>

<p>Neben der Kür kommt auch immer noch die Pflicht. Was du wissen musst, findest du hier.</p>

                    </div>
                    <div class="cell medium-6 large-3">
                        <p><a href="https://btv-turnen.de/der-btv/ueber-uns/datenschutz" target="_blank">Datenschutz</a></p>

<p>Deine Daten sind bei uns sicher! Bedenken? Dann findest du hier alle Infos.</p>


                                            </div>
                </div>
            </div>
        </div>
        <div class="grid-container">
            <div class="grid-x grid-margin-x">
                <div class="cell">
                    <nav>
                        <ul>
                                                                                                                                        <li>
                                            <a  class= main href="/der-btv">
                                                Der BTV
                                            </a>
                                        </li>
                                                                                                                                                <li>
                                            <a  class= main href="/bildung">
                                                Bildung
                                            </a>
                                        </li>
                                                                                                                                                <li>
                                            <a  class= main href="/sport">
                                                Sport
                                            </a>
                                        </li>
                                                                                                                                                <li>
                                            <a  class= main href="/turnerjugend">
                                                Turnerjugend
                                            </a>
                                        </li>
                                                                                                                                                                                                                    <li>
                                            <a  class= main href="/vereinsservice">
                                                Vereinsservice
                                            </a>
                                        </li>
                                                                                                                                                <li>
                                            <a  class=icon search main href="/suche">
                                                Suche
                                            </a>
                                        </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ul>
                    </nav>
                </div>
                <div class="cell text-center">
                                            <a href="/" class="logo">
                            <picture >
	<source srcset="/sport/regionen_hier_nicht/oberfranken/logo-btv-tbz-oberfranken.svg 1x" type="image/svg+xml" />
	<img src="/sport/regionen_hier_nicht/oberfranken/logo-btv-tbz-oberfranken.svg" width="168" height="60" alt="" loading="lazy" />
</picture>

                        </a>
                                    </div>
                <div class="cell text-center">
                    <p>
                        © Bayerischer Turnverband e.V., 2022
                    </p>
                </div>
            </div>
        </div>
    </footer>


            
                
     
    
    
    <aside class="sidebar">
        <nav>
            <ul>
                                                            
                            <li>
                                <a  class="icon contact main" href="/kontakt">
                                    Kontakt
                                </a>
                            </li>
                                                                        </ul>
        </nav>
    </aside>`;

  // news-gallery
  const months = {
    Dez: 0,
    Jan: 1,
    Feb: 2,
    Mär: 3,
    Apr: 4,
    Mai: 5,
    Jun: 6,
    Jul: 7,
    Aug: 8,
    Sep: 9,
    Okt: 10,
    Nov: 11,
  };
  const revMonths = Object.entries(months).reduce((st, [k, v]) => {
    st[v] = k;
    return st;
  }, {});
  const days = ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'];
  let dataNews = [];

  const loadNewsItem = (link) =>
    fetch(`${link}`)
      .then((_) => _.text())
      .then((_) => {
        const temp = document.createElement('div');
        temp.innerHTML = _.split(
          '<article class="brick_blog list cell">'
        )[1].split('</article>')[0];
        const [from, to] = temp
          .querySelector('div.h6')
          .innerText.split('-')
          .map((_) => _.trim().split('.').reverse());
        return {
          from: new Date(from),
          to: !to ? undefined : new Date(to),
          details: temp.querySelector('div.copy').innerText.trim(),
        };
      });

  const loadNewsList = (page, test) =>
    (!!test
      ? Promise.resolve(test)
      : fetch(`${window.location.origin}/events?page=${page}`).then((_) =>
          _.text()
        )
    ).then((_) => {
      const temp = document.createElement('div');
      temp.innerHTML = _.split(
        '<article class="brick_event list cell">'
      )[1].split('</article>')[0];
      return [...temp.querySelectorAll('[class="cell"]')]
        .map((_) => ({
          place: (_.querySelector('div.place') || { innerText: '' }).innerText,
          category: (_.querySelector('div.category') || { innerText: '' })
            .innerText,
          title: (
            _.querySelector('h2.h4') || { innerText: '' }
          ).innerText.trim(),
          img: (_.querySelector('img') || { src: '' }).src.trim(),
          link: (_.querySelector('a') || { href: '' }).href.trim(),
        }))
        .filter((_) => !!_.title);
    });

  const loadNewsChunk = (page, test) =>
    loadNewsList(page, test)
      .then((_) =>
        Promise.all(
          _.map((_) =>
            loadNewsItem(_.link)
              .then((item) => ({ ..._, ...item }))
              .then((_) => {
                formatterNews(_, true);
                return _;
              })
          )
        )
      )
      .then((_) => {
        console.log(_);
        return _;
      })
      .then((next) =>
        next.length && !test
          ? loadNewsChunk(page + 1, '').then((_) => [...next, ..._])
          : next
      );
  loadNewsChunk(1, test)
    .then((_) =>
        _.filter((_) => (_.to && new Date() < _.to) || new Date() < _.from)
      )
    .then((dataNews) => formatterNews(dataNews));

  const formatterNews = (dataNews, loading) => {
    document.querySelector('#news div.content').innerHTML = !!loading
      ? 'Lade weitere Nachrichten' + dataNews.length
      : dataNews
          .map(
            (_) =>
              `<a href="${
                _.link
              }" style="margin:0rem; padding:0.5rem; display: flex; border-bottom: 1px solid lightgray;">
            <div style="width: 125px; display: flex; align-items: center">
              <div style="display: flex; flex-direction: column; align-items: center;">
                <span>
                  ${days[_.from.getDay()]}
                </span>
                <span style="font-size: 2rem; font-weight: bold;">
                  ${('00' + _.from.getDate()).slice(-2)} 
                </span>
                <span>
                  ${revMonths[_.from.getMonth()]} 
                </span>
              </div>
            ${
              !!_.to
                ? `
                <span style="font-size: 2rem; font-weight: bold; padding: 0.5rem;">-</span>
                <div style="display: flex; flex-direction: column; align-items: center;">
                  <span>
                    ${days[_.to.getDay()]}
                  </span>
                  <span style="font-size: 2rem; font-weight: bold;">
                    ${('00' + _.to.getDate()).slice(-2)} 
                  </span>
                  <span>
                    ${revMonths[_.to.getMonth()]} 
                  </span>
                </div>`
                : ''
            }
            </div>
            ${
              _.img
                ? `<img style="width: 100px;" src="${_.img}" />`
                : `<div style="width: 100px;"></div>`
            }
            <div>
            ${_.place ? _.place : 'Kein Ort'} | ${_.category ? _.category : ''} 
            <br />
            ${_.title}
            </div>
          </a>`
          )
          .join('') +
        ['', '', '', '', '']
          .map(
            () =>
              '<div style="flex: 1 0 11%; margin: 0; padding: 0; min-width: 300px"></div>'
          )
          .join('');
  };

  setTimeout(() => {
    /*    document.querySelector(
      '#news div.control'
    ).innerHTML = `<span>Stand: ${stand}</span><input
    placeholder="Suche"
    type="text"
    style="
      display: flex;
      flex-wrap: wrap;
      padding: 0.5rem;
      border: none;
      border-bottom: 3px solid #1d71b9;
      outline: none;
      width: auto;
    "
  />`;*/
    /*    document
      .querySelector('#news div.control input')
      .addEventListener('keydown', (e) =>
        formatterNews(
          dataNews.filter((_) => JSON.stringify(_).includes(e.target.value))
        )
      );*/
  }, 100);
</script>
